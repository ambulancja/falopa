
infix  300 _⊢_∷_
infix  300 _∈_∷_
infix  350 _,_
infixr 400 _->_
infix  400 \_
infixl 450 _`_
infixr 500 _×_
infixr 500 _|_

data A × B where
  _|_ : A → B → A × B

data ℕ where
  zero : ℕ
  suc  : ℕ → ℕ

data Term where
  var   : ℕ → Term
  _`_   : Term → Term → Term
  \_  : Term → Term

data Type where
  base : Int → Type
  _->_ : Type → Type → Type

data Context where
  empty : Context
  _,_   : Context → Type → Context

zero  ∈ (Γ , A) ∷ A    = ()
suc x ∈ (Γ , _) ∷ A    = x ∈ Γ ∷ A
Γ ⊢ var x    ∷ A       = x ∈ Γ ∷ A
Γ ⊢ \ t      ∷ A -> B  = Γ , A ⊢ t ∷ B
Γ ⊢ t ` s    ∷ B       = Γ ⊢ t ∷ A -> B
                      >> Γ ⊢ s ∷ A
  where A = _

main = witness (A -> B -> A)
  where A = base 0
        B = base 1
        witness formula = empty ⊢ w ∷ formula >> w
          where w = _

